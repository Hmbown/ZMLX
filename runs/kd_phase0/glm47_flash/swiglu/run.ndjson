{"candidate_id": "swiglu_e79b57774f9d99c2", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.037458, "correctness_max_abs_err": 0.0, "correctness_max_rel_err": 0.0, "dtype": "float16", "gbps_est": 23.58821902525217, "latency_us": 179.125, "p10_us": 145.833, "p90_us": 270.458, "per_shape": [{"baseline_us": 153.75, "gbps_est": 7.871982062540876, "latency_us": 149.85399999999998, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 134.292, "p90_us": 193.834, "shape": {"D": 1536, "N": 196608, "rows": 128}, "speedup_vs_ref": 1.025998638674977}, {"baseline_us": 217.04149999999998, "gbps_est": 14.375038461655633, "latency_us": 164.1245, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 152.792, "p90_us": 186.041, "shape": {"D": 1536, "N": 393216, "rows": 256}, "speedup_vs_ref": 1.322419870281402}, {"baseline_us": 231.5625, "gbps_est": 25.94414845360825, "latency_us": 181.875, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 169.958, "p90_us": 381.167, "shape": {"D": 1536, "N": 786432, "rows": 512}, "speedup_vs_ref": 1.2731958762886597}, {"baseline_us": 285.1665, "gbps_est": 46.16170712320391, "latency_us": 204.4375, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 178.5, "p90_us": 243.208, "shape": {"D": 1536, "N": 1572864, "rows": 1024}, "speedup_vs_ref": 1.3948835218587587}], "reference_latency_us": 226.5, "speedup_vs_ref": 1.264480111653873}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "benchmarked", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_2e25923f47695ec0", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.023208, "correctness_max_abs_err": 519.703125, "correctness_max_rel_err": 72796056.86440678, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_4eec4988965716bf", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021083, "correctness_max_abs_err": 520.21875, "correctness_max_rel_err": 1929687500000.0, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_e43960fc00fe5780", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v2_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.016667, "correctness_max_abs_err": 518.65625, "correctness_max_rel_err": 252645134.05882353, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_545d155bf0e12db7", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.02025, "correctness_max_abs_err": 520.40625, "correctness_max_rel_err": 220254734.12820512, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_01e9a4843d2d7508", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.017541, "correctness_max_abs_err": 517.640625, "correctness_max_rel_err": 232160393.3783784, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_9225f4c9b0899914", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v1_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.015, "correctness_max_abs_err": 518.42578125, "correctness_max_rel_err": 20164166.70892019, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_b4db77322410236f", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.014709, "correctness_max_abs_err": 519.16796875, "correctness_max_rel_err": 104755298.90243903, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_ff64e29f24362109", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021167, "correctness_max_abs_err": 519.703125, "correctness_max_rel_err": 1227133514.142857, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_051ef4e12e752797", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.024958, "correctness_max_abs_err": 519.05078125, "correctness_max_rel_err": 1680664062500.0, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_05de87ab2e04b348", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.016542, "correctness_max_abs_err": 518.7578125, "correctness_max_rel_err": 182764564.78723404, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_4eec4988965716bf", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_30fb127ceff802c1", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.016625, "correctness_max_abs_err": 519.10546875, "correctness_max_rel_err": 954437177.8888888, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_545d155bf0e12db7", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_74ce201fe49cfc85", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n196608_tg256_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.015625, "correctness_max_abs_err": 519.31640625, "correctness_max_rel_err": 117670335.87671232, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_e79b57774f9d99c2", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_0a0f6551d6731357", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n196608_tg256_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.014667, "correctness_max_abs_err": 517.21875, "correctness_max_rel_err": 613566757.5714285, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_01e9a4843d2d7508", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_8c8d0fc31811cc1a", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.0625}, "func_name": "kk_kd_swiglu_n196608_tg64_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 64, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018333, "correctness_max_abs_err": 518.7890625, "correctness_max_rel_err": 7812500000.0, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_e79b57774f9d99c2", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_c0be10610e53c6fa", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.0185, "correctness_max_abs_err": 520.6015625, "correctness_max_rel_err": 858993460.2, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_221ef8ebc6411a30", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_ae47afd089846e0d", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.022416, "correctness_max_abs_err": 519.046875, "correctness_max_rel_err": 153391688.14285713, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_74ce201fe49cfc85", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_03669763772f2d84", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n196608_tg512_v2_u4_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 4, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.016834, "correctness_max_abs_err": 520.859375, "correctness_max_rel_err": 954437177.8888888, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_05de87ab2e04b348", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 4, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_c7715468775e3b8f", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n196608_tg256_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.015167, "correctness_max_abs_err": 519.97265625, "correctness_max_rel_err": 97612894.0909091, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_4eec4988965716bf", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:18-0600"}
{"candidate_id": "swiglu_3682c6a110fc8f82", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 1179648.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n196608_tg128_v2_u4_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [196608], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [196608], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 4, "vec_width": 2}, "metal_source": "constexpr uint N = 196608;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.016541, "correctness_max_abs_err": 517.58203125, "correctness_max_rel_err": 63161282.76470588, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 1536, "N": 196608, "rows": 128}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [196608], "strides": "contiguous"}], "parent_id": "swiglu_74ce201fe49cfc85", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": true, "unroll": 4, "vec_width": 2}, "ts": "2026-02-09T19:12:18-0600"}
