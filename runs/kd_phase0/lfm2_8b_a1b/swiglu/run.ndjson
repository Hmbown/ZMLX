{"candidate_id": "swiglu_17b9b3778cca546b", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.028541, "correctness_max_abs_err": 0.0, "correctness_max_rel_err": 0.0, "dtype": "float16", "gbps_est": 0.7379907566717772, "latency_us": 135.813, "p10_us": 125.042, "p90_us": 158.167, "per_shape": [{"baseline_us": 141.937, "gbps_est": 0.3174502415494595, "latency_us": 135.4795, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 126.792, "p90_us": 142.375, "shape": {"D": 7168, "N": 7168, "rows": 1}, "speedup_vs_ref": 1.047664037732646}, {"baseline_us": 165.0625, "gbps_est": 0.6609218144307717, "latency_us": 130.1455, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 121.5, "p90_us": 181.125, "shape": {"D": 7168, "N": 14336, "rows": 2}, "speedup_vs_ref": 1.2682920270005493}, {"baseline_us": 142.0205, "gbps_est": 1.2356002140351001, "latency_us": 139.2295, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 127.125, "p90_us": 147.625, "shape": {"D": 7168, "N": 28672, "rows": 4}, "speedup_vs_ref": 1.0200460390937265}], "reference_latency_us": 147.77100000000002, "speedup_vs_ref": 1.088047535950167}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "benchmarked", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_eaa8137dc75ef7de", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.022667, "correctness_max_abs_err": 517.00390625, "correctness_max_rel_err": 1932929.5760576057, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_7d69bff7cb064902", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018833, "correctness_max_abs_err": 516.02734375, "correctness_max_rel_err": 2471213.483314154, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_8ddfbd2dfe9ba920", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v2_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018292, "correctness_max_abs_err": 516.19921875, "correctness_max_rel_err": 4297116.853926963, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_d7b85b43ab9b896c", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021542, "correctness_max_abs_err": 516.1640625, "correctness_max_rel_err": 1431654.7653333333, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_07dc576f148ed164", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020709, "correctness_max_abs_err": 515.923828125, "correctness_max_rel_err": 512000000000000.0, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_bbe175487d4cad06", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v1_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020333, "correctness_max_abs_err": 519.22265625, "correctness_max_rel_err": 2716613.355471221, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_938ea39b6c05d82c", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019333, "correctness_max_abs_err": 515.375, "correctness_max_rel_err": 186737707.52173913, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_3139bbd079eda32d", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020834, "correctness_max_abs_err": 517.66796875, "correctness_max_rel_err": 5666184.767810026, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_13f594da98411188", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020208, "correctness_max_abs_err": 516.734375, "correctness_max_rel_err": 7122664.499170813, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_9dbccd13af921676", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.017833, "correctness_max_abs_err": 515.376953125, "correctness_max_rel_err": 24826399.554913294, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_7d69bff7cb064902", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_03af7f287568d188", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.023708, "correctness_max_abs_err": 516.30859375, "correctness_max_rel_err": 20748635.280193236, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_d7b85b43ab9b896c", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_c1482b318e6c4113", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n7168_tg256_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.022709, "correctness_max_abs_err": 517.3984375, "correctness_max_rel_err": 2576464.084583083, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_17b9b3778cca546b", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_f8f87136fc4031ce", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n7168_tg256_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019667, "correctness_max_abs_err": 517.5703125, "correctness_max_rel_err": 14887235.994800692, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_07dc576f148ed164", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_608cd94010fb5707", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.0625}, "func_name": "kk_kd_swiglu_n7168_tg64_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 64, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020541, "correctness_max_abs_err": 519.23046875, "correctness_max_rel_err": 110127367.56410256, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_17b9b3778cca546b", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_a49e3bc409ddc0ae", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.02025, "correctness_max_abs_err": 520.140625, "correctness_max_rel_err": 3824546.9038290293, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_8eac703600040e90", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_e481eda69f1d40cc", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.017875, "correctness_max_abs_err": 516.07421875, "correctness_max_rel_err": 4051854.9396226415, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_c1482b318e6c4113", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_f05112098a6029c5", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n7168_tg512_v2_u4_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 4, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021417, "correctness_max_abs_err": 516.609375, "correctness_max_rel_err": 330382100.6923077, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_9dbccd13af921676", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 4, "vec_width": 2}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_6996e1d53c590078", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n7168_tg256_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.02, "correctness_max_abs_err": 516.41796875, "correctness_max_rel_err": 7261144.048182586, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_7d69bff7cb064902", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:42-0600"}
{"candidate_id": "swiglu_8636dbe259b4f51c", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 43008.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n7168_tg128_v2_u4_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [7168], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [7168], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 4, "vec_width": 2}, "metal_source": "constexpr uint N = 7168;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.017792, "correctness_max_abs_err": 515.376953125, "correctness_max_rel_err": 3943956.2764003673, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 7168, "N": 7168, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [7168], "strides": "contiguous"}], "parent_id": "swiglu_c1482b318e6c4113", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": true, "unroll": 4, "vec_width": 2}, "ts": "2026-02-09T19:12:43-0600"}
