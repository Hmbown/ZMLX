{"candidate_id": "swiglu_7470046f4cbdfe5f", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.031667, "correctness_max_abs_err": 0.0, "correctness_max_rel_err": 0.0, "dtype": "float16", "gbps_est": 0.20057838333003022, "latency_us": 147.0, "p10_us": 127.208, "p90_us": 151.75, "per_shape": [{"baseline_us": 157.97899999999998, "gbps_est": 0.08203402729794416, "latency_us": 149.79149999999998, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 146.0, "p90_us": 151.042, "shape": {"D": 2048, "N": 2048, "rows": 1}, "speedup_vs_ref": 1.0546593097739192}, {"baseline_us": 146.72899999999998, "gbps_est": 0.18533377575337098, "latency_us": 132.60399999999998, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 125.917, "p90_us": 139.25, "shape": {"D": 2048, "N": 4096, "rows": 2}, "speedup_vs_ref": 1.106520165304214}, {"baseline_us": 160.8745, "gbps_est": 0.33436734693877557, "latency_us": 147.0, "max_abs_err": 0.0, "max_rel_err": 0.0, "p10_us": 141.583, "p90_us": 157.375, "shape": {"D": 2048, "N": 8192, "rows": 4}, "speedup_vs_ref": 1.0943843537414968}], "reference_latency_us": 150.79149999999998, "speedup_vs_ref": 1.0257925170068025}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "benchmarked", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:32-0600"}
{"candidate_id": "swiglu_1fa2dba59c1c68e1", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.023834, "correctness_max_abs_err": 514.107421875, "correctness_max_rel_err": 2526450.350588235, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:32-0600"}
{"candidate_id": "swiglu_cf6ce32938a5ec0e", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019208, "correctness_max_abs_err": 516.859375, "correctness_max_rel_err": 567216.0227152668, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_bac9a3d62533c54c", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v2_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021542, "correctness_max_abs_err": 514.490234375, "correctness_max_rel_err": 2523483.5475910692, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_a13d0fe91d9d29c1", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v1_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020541, "correctness_max_abs_err": 514.666015625, "correctness_max_rel_err": 1199040.6795086544, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_8993fdbd7068ac48", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019416, "correctness_max_abs_err": 515.77734375, "correctness_max_rel_err": 2014523.9981238274, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_b64b0e8b4254b23e", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v1_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018917, "correctness_max_abs_err": 515.05859375, "correctness_max_rel_err": 3618339.0758213983, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_5e1499c36e96ba1e", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v2_u1_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019333, "correctness_max_abs_err": 513.904296875, "correctness_max_rel_err": 783182.4908825675, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 0, "template_params": {"fast_sigmoid": true, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_f5039a564f7d6aa0", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018667, "correctness_max_abs_err": 515.259765625, "correctness_max_rel_err": 556630.3240020736, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_e8e35a36196775f8", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v2_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 2, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020125, "correctness_max_abs_err": 515.3046875, "correctness_max_rel_err": 662802.5950617284, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_fa7388cbce20db3d", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021916, "correctness_max_abs_err": 514.16015625, "correctness_max_rel_err": 1090647.850177755, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_cf6ce32938a5ec0e", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_95d63ea172a90e8b", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020291, "correctness_max_abs_err": 515.642578125, "correctness_max_rel_err": 1249991.4819557625, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_a13d0fe91d9d29c1", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_b41963c0bc30ea54", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n2048_tg256_v1_u2_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.018917, "correctness_max_abs_err": 517.00390625, "correctness_max_rel_err": 5692469.251822399, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_7470046f4cbdfe5f", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 2, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_6bcb625e7bac41d3", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n2048_tg256_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.020333, "correctness_max_abs_err": 514.52734375, "correctness_max_rel_err": 9586979.57142857, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_8993fdbd7068ac48", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_7a871a4e6dd0472e", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.0625}, "func_name": "kk_kd_swiglu_n2048_tg64_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 64, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019, "correctness_max_abs_err": 516.51953125, "correctness_max_rel_err": 10046706.125146199, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_7470046f4cbdfe5f", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_922fd58be5a0869c", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v2_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 1, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019625, "correctness_max_abs_err": 515.353515625, "correctness_max_rel_err": 685222.3299298022, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_415d8669d6e6bfb7", "seed": 0, "status": "failed", "step": 1, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_459117d975c8aaa0", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v1_u1_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 1, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 1;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.0195, "correctness_max_abs_err": 514.578125, "correctness_max_rel_err": 1179289.1098297639, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_b41963c0bc30ea54", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 1, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_abaf2c63c4d08b14", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.5}, "func_name": "kk_kd_swiglu_n2048_tg512_v2_u4_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 512, "unroll": 4, "vec_width": 2}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 2;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.019791, "correctness_max_abs_err": 515.974609375, "correctness_max_rel_err": 2271268.739820201, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_fa7388cbce20db3d", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 4, "vec_width": 2}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_4b82cfe0355e9725", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.25}, "func_name": "kk_kd_swiglu_n2048_tg256_v4_u2_fast1", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 256, "unroll": 2, "vec_width": 4}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 4;\nconstexpr uint UNROLL = 2;\nconstexpr bool FAST_SIGMOID = true;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.021958, "correctness_max_abs_err": 515.703125, "correctness_max_rel_err": 1748766.1856677525, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_cf6ce32938a5ec0e", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": true, "unroll": 2, "vec_width": 4}, "ts": "2026-02-09T19:12:33-0600"}
{"candidate_id": "swiglu_4078ffde83868c3a", "event": "evaluation", "features": {"arithmetic_intensity_est": 1.3333333333333333, "bytes_moved_est": 12288.0, "launch_occupancy_proxy": 0.125}, "func_name": "kk_kd_swiglu_n2048_tg128_v1_u4_fast0", "inputs_spec": [{"dtype": "float16", "name": "gate", "shape": [2048], "strides": "contiguous"}, {"dtype": "float16", "name": "up", "shape": [2048], "strides": "contiguous"}], "launch_params": {"launch_kind": "swiglu_flat", "threadgroup_x": 128, "unroll": 4, "vec_width": 1}, "metal_source": "constexpr uint N = 2048;\nconstexpr uint VEC = 1;\nconstexpr uint UNROLL = 4;\nconstexpr bool FAST_SIGMOID = false;\n\nuint tid = thread_position_in_grid.x;\nuint base = tid * VEC * UNROLL;\n\n#pragma unroll\nfor (uint u = 0; u < UNROLL; ++u) {\n    uint idx0 = base + u * VEC;\n    if (idx0 >= N) {\n        continue;\n    }\n\n    #pragma unroll\n    for (uint v = 0; v < VEC; ++v) {\n        uint idx = idx0 + v;\n        if (idx >= N) {\n            continue;\n        }\n\n        float g = (float)gate[idx];\n        float upv = (float)up[idx];\n        float sig;\n        if (FAST_SIGMOID) {\n            sig = kk_sigmoid(g);\n        } else {\n            sig = 1.0f / (1.0f + metal::exp(-g));\n        }\n        out[idx] = (T)(g * sig * upv);\n    }\n}\n", "metrics": {"compile_time_ms": 0.017291, "correctness_max_abs_err": 515.818359375, "correctness_max_rel_err": 967335.9765765766, "failure": "correctness_error", "failure_reason": "outputs differ from reference"}, "notes": {"dtype": "float16", "shape_signature": {"D": 2048, "N": 2048, "rows": 1}, "shape_suite": "glm_flash_small"}, "op_name": "swiglu", "outputs_spec": [{"dtype": "float16", "name": "out", "shape": [2048], "strides": "contiguous"}], "parent_id": "swiglu_e8e35a36196775f8", "seed": 0, "status": "failed", "step": 2, "template_params": {"fast_sigmoid": false, "unroll": 4, "vec_width": 1}, "ts": "2026-02-09T19:12:33-0600"}
