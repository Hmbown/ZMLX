{
  "suite": "glm47",
  "timestamp_utc": "20260210T230641Z",
  "script": "bench_glm47_flash_experiments.py",
  "runs": 3,
  "max_tokens": 200,
  "variants": [
    "control_swiglu_moe",
    "glm_combine_fp32_no_fma",
    "shared_experts_overlap_streams2",
    "glm47_rope",
    "glm_combine_fp32_no_fma_shared_overlap_streams2",
    "glm_combine_fp32_no_fma_glm47_rope"
  ],
  "env_overrides": {},
  "results": [
    {
      "variant": "control_swiglu_moe",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_control_swiglu_moe.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_control_swiglu_moe.json",
        "--variants",
        "control_swiglu_moe",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "control_swiglu_moe",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 83.6,
          "patched": 80.2,
          "speedup": 0.9593
        },
        "prefill": {
          "baseline": 284.4,
          "patched": 282.7,
          "change": -0.006
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    },
    {
      "variant": "glm_combine_fp32_no_fma",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma.json",
        "--variants",
        "glm_combine_fp32_no_fma",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "glm_combine_fp32_no_fma",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 85.3,
          "patched": 81.3,
          "speedup": 0.9531
        },
        "prefill": {
          "baseline": 287.7,
          "patched": 285.4,
          "change": -0.008
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    },
    {
      "variant": "shared_experts_overlap_streams2",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_shared_experts_overlap_streams2.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_shared_experts_overlap_streams2.json",
        "--variants",
        "shared_experts_overlap_streams2",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "shared_experts_overlap_streams2",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 84.9,
          "patched": 59.5,
          "speedup": 0.7008
        },
        "prefill": {
          "baseline": 286.7,
          "patched": 252.1,
          "change": -0.1207
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    },
    {
      "variant": "glm47_rope",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm47_rope.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm47_rope.json",
        "--variants",
        "glm47_rope",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "glm47_rope",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 85.2,
          "patched": 77.4,
          "speedup": 0.9085
        },
        "prefill": {
          "baseline": 286.3,
          "patched": 279.6,
          "change": -0.0234
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    },
    {
      "variant": "glm_combine_fp32_no_fma_shared_overlap_streams2",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma_shared_overlap_streams2.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma_shared_overlap_streams2.json",
        "--variants",
        "glm_combine_fp32_no_fma_shared_overlap_streams2",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "glm_combine_fp32_no_fma_shared_overlap_streams2",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 82.0,
          "patched": 58.4,
          "speedup": 0.7122
        },
        "prefill": {
          "baseline": 277.8,
          "patched": 246.3,
          "change": -0.1134
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    },
    {
      "variant": "glm_combine_fp32_no_fma_glm47_rope",
      "return_code": 0,
      "capsule": "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma_glm47_rope.json",
      "command": [
        "python",
        "benchmarks/bench_glm47_flash_experiments.py",
        "--runs",
        "3",
        "--max-tokens",
        "200",
        "--json-out",
        "benchmarks/repro_capsules/glm47_benchmark_vs_baseline_t200_r3_repA_20260210_glm_combine_fp32_no_fma_glm47_rope.json",
        "--variants",
        "glm_combine_fp32_no_fma_glm47_rope",
        "--ledger",
        "benchmarks/matrix.jsonl"
      ],
      "env": {},
      "metrics": {
        "variant": "glm_combine_fp32_no_fma_glm47_rope",
        "fidelity": {
          "matched": 200,
          "total": 200,
          "verdict": "PASS"
        },
        "decode": {
          "baseline": 81.7,
          "patched": 74.2,
          "speedup": 0.9082
        },
        "prefill": {
          "baseline": 279.9,
          "patched": 273.5,
          "change": -0.0229
        },
        "memory_gb": {
          "baseline": 15.98,
          "patched": 15.98
        }
      }
    }
  ]
}