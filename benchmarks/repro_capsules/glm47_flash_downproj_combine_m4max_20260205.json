{
  "meta": {
    "date": "2026-02-05",
    "device": "Apple M4 Max",
    "memory_gb": 36,
    "macos": "26.1",
    "mlx_version": "0.30.4.dev20260204+2f324cc",
    "zmlx_version": "0.8.0",
    "git_commit": "8c00216",
    "python": "3.14",
    "has_gather_qmm_swiglu": true,
    "command_control_swiglu_moe": "python -m zmlx.validate mlx-community/GLM-4.7-Flash-4bit --patterns swiglu_mlp moe_mlp --runs 3 --max-tokens 200",
    "command_control_swiglu_moe_downproj_combine": "ZMLX_GLM_FUSED_DOWNPROJ_COMBINE=1 python -m zmlx.validate mlx-community/GLM-4.7-Flash-4bit --patterns swiglu_mlp moe_mlp --runs 3 --max-tokens 200"
  },
  "control_swiglu_moe": {
    "model": "mlx-community/GLM-4.7-Flash-4bit",
    "variant": "control_swiglu_moe",
    "max_tokens": 200,
    "gen_tokens": 200,
    "runs": 3,
    "fidelity": {
      "matched": 200,
      "total": 200,
      "verdict": "PASS"
    },
    "baseline": {
      "prefill_tok_s": [
        293.6,
        259.3,
        274.4
      ],
      "decode_tok_s": [
        86.4,
        87.6,
        87.6
      ],
      "median_prefill": 274.4,
      "median_decode": 87.6,
      "peak_mem_gb": 16.91
    },
    "patched": {
      "patterns": [
        "moe_mlp",
        "swiglu_mlp"
      ],
      "modules_patched": 47,
      "prefill_tok_s": [
        307.3,
        270.0,
        269.2
      ],
      "decode_tok_s": [
        91.9,
        93.8,
        93.8
      ],
      "median_prefill": 270.0,
      "median_decode": 93.8,
      "peak_mem_gb": 16.91
    },
    "summary": {
      "decode_speedup": 1.0708,
      "prefill_change": -0.016
    },
    "notes": "Control: current best patch set (no RoPE fusion)."
  },
  "control_swiglu_moe_downproj_combine": {
    "model": "mlx-community/GLM-4.7-Flash-4bit",
    "variant": "control_swiglu_moe_downproj_combine",
    "max_tokens": 200,
    "gen_tokens": 200,
    "runs": 3,
    "fidelity": {
      "matched": 0,
      "total": 200,
      "verdict": "SKIP"
    },
    "baseline": {
      "prefill_tok_s": [
        293.6,
        259.3,
        274.4
      ],
      "decode_tok_s": [
        86.4,
        87.6,
        87.6
      ],
      "median_prefill": 274.4,
      "median_decode": 87.6,
      "peak_mem_gb": 16.91
    },
    "patched": {
      "patterns": [
        "swiglu_mlp",
        "moe_mlp"
      ],
      "modules_patched": 0,
      "prefill_tok_s": [],
      "decode_tok_s": [],
      "median_prefill": 0.0,
      "median_decode": 0.0,
      "peak_mem_gb": 0.0
    },
    "summary": {
      "decode_speedup": 0.0,
      "prefill_change": -1.0
    },
    "notes": "Experimental: fuse down-proj + combine for decode-like shapes (GLM only; token-fidelity-sensitive).",
    "error": "SKIPPED: unsafe variant (pass --allow-unsafe to run; may crash with Metal OOM)"
  }
}
