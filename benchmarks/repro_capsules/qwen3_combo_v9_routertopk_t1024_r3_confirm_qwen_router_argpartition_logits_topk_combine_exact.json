{
  "meta": {
    "date": "2026-02-10",
    "device": "Apple M4 Max",
    "memory_gb": 36,
    "macos": "26.1",
    "mlx_version": "0.30.7.dev20260207+8fe1d092",
    "zmlx_version": "0.8.3",
    "git_commit": "094296f",
    "python": "3.14",
    "has_gather_qmm_swiglu": true,
    "command_qwen_router_argpartition_logits_topk_combine_exact": "ZMLX_QWEN_ROUTER_ARGPARTITION_LOGITS=1 ZMLX_QWEN_ROUTER_ARGPARTITION_LOGITS_TOPK=1 ZMLX_QWEN_COMBINE_MODE=exact python -m zmlx.validate mlx-community/Qwen3-30B-A3B-4bit --runs 3 --max-tokens 1024 --patterns moe_mlp"
  },
  "qwen_router_argpartition_logits_topk_combine_exact": {
    "model": "mlx-community/Qwen3-30B-A3B-4bit",
    "variant": "qwen_router_argpartition_logits_topk_combine_exact",
    "max_tokens": 1024,
    "gen_tokens": 1024,
    "runs": 3,
    "fidelity": {
      "matched": 1024,
      "total": 1024,
      "verdict": "PASS"
    },
    "baseline": {
      "prefill_tok_s": [
        324.8,
        334.5,
        334.2
      ],
      "decode_tok_s": [
        113.3,
        113.1,
        109.3
      ],
      "median_prefill": 334.2,
      "median_decode": 113.1,
      "peak_mem_gb": 17.33
    },
    "patched": {
      "patterns": [
        "moe_mlp"
      ],
      "modules_patched": 48,
      "prefill_tok_s": [
        340.8,
        336.0,
        333.8
      ],
      "decode_tok_s": [
        118.7,
        118.1,
        119.1
      ],
      "median_prefill": 336.0,
      "median_decode": 118.7,
      "peak_mem_gb": 17.34
    },
    "summary": {
      "decode_speedup": 1.0495,
      "prefill_change": 0.0054
    },
    "notes": "Experimental: Qwen argpartition(logits) fused top-k softmax plus exact combine kernel (ZMLX_QWEN_ROUTER_ARGPARTITION_LOGITS=1 ZMLX_QWEN_ROUTER_ARGPARTITION_LOGITS_TOPK=1 ZMLX_QWEN_COMBINE_MODE=exact)"
  }
}
