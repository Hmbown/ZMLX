{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_control_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:01:40.104915+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":86.6,"decode_tps_patched":92.4,"decode_speedup":1.067,"decode_runs_baseline":[86.4,86.6,86.8],"decode_runs_patched":[92.5,92.4,92.0],"prefill_tps_baseline":275.5,"prefill_tps_patched":279.4,"prefill_change":0.0142,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["glm47_rope","moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Decode-only fused RoPE+concat for glm4_moe_lite attention. capsule=benchmarks/repro_capsules/glm47_flash_rope_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:03:53.566831+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":94,"decode_tps_baseline":86.5,"decode_tps_patched":91.1,"decode_speedup":1.0532,"decode_runs_baseline":[84.9,86.8,86.5],"decode_runs_patched":[92.0,91.1,91.0],"prefill_tps_baseline":276.9,"prefill_tps_patched":280.3,"prefill_change":0.0123,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: overlap shared_experts(x) on a separate stream. capsule=benchmarks/repro_capsules/glm47_flash_shared_overlap_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:06:18.468406+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":87.1,"decode_tps_patched":61.4,"decode_speedup":0.7049,"decode_runs_baseline":[85.1,87.1,87.1],"decode_runs_patched":[61.5,61.4,61.2],"prefill_tps_baseline":276.0,"prefill_tps_patched":243.3,"prefill_change":-0.1185,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_control_kv4_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"e1165ef","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T05:46:01.048859+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":73.9,"decode_tps_patched":80.7,"decode_speedup":1.092,"decode_runs_baseline":[73.2,74.1,73.9],"decode_runs_patched":[81.1,79.3,80.7],"prefill_tps_baseline":285.6,"prefill_tps_patched":292.2,"prefill_change":0.0231,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":17.51,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","residual_norm","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: residual_norm fusion (breaks greedy token fidelity on GLM-4.7-Flash in current testing). capsule=benchmarks/repro_capsules/glm47_flash_residual_norm_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"2f08b4e","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T05:58:35.761777+00:00","fidelity":"FAIL","fidelity_detail":"1/200 tokens identical","modules_patched":94,"decode_tps_baseline":80.7,"decode_tps_patched":87.3,"decode_speedup":1.0818,"decode_runs_baseline":[77.9,80.7,85.5],"decode_runs_patched":[87.3,86.7,88.3],"prefill_tps_baseline":273.9,"prefill_tps_patched":270.4,"prefill_change":-0.0128,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_downproj_combine_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"8c00216","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T09:14:16.824460+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":87.6,"decode_tps_patched":93.8,"decode_speedup":1.0708,"decode_runs_baseline":[86.4,87.6,87.6],"decode_runs_patched":[91.9,93.8,93.8],"prefill_tps_baseline":274.4,"prefill_tps_patched":270.0,"prefill_change":-0.016,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["swiglu_mlp","moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: fuse down-proj + combine for decode-like shapes (GLM only; token-fidelity-sensitive). capsule=benchmarks/repro_capsules/glm47_flash_downproj_combine_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"8c00216","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T09:14:16.829819+00:00","fidelity":"SKIP","fidelity_detail":"SKIPPED: unsafe variant (pass --allow-unsafe to run; may crash with Metal OOM)","modules_patched":0,"decode_tps_baseline":87.6,"decode_tps_patched":0.0,"decode_speedup":0.0,"decode_runs_baseline":[86.4,87.6,87.6],"decode_runs_patched":[],"prefill_tps_baseline":274.4,"prefill_tps_patched":0.0,"prefill_change":-1.0,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":0.0,"max_tokens":200,"gen_tokens":0,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"perf/qwen3-glm47-next baseline control","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"812f21f","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T13:12:26.917441+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":78.18,"decode_tps_patched":79.81,"decode_speedup":1.0208,"decode_runs_baseline":[77.7,78.76,78.18],"decode_runs_patched":[74.7,79.81,81.58],"prefill_tps_baseline":260.31,"prefill_tps_patched":261.2,"prefill_change":0.0034,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"perf/qwen3-glm47-next baseline qwen3","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"812f21f","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T13:15:38.086899+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":105.61,"decode_tps_patched":112.61,"decode_speedup":1.0663,"decode_runs_baseline":[105.66,103.95,105.61],"decode_runs_patched":[112.79,112.61,112.21],"prefill_tps_baseline":314.06,"prefill_tps_patched":316.6,"prefill_change":0.0081,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_nokv_t1024_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"48c7570","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:21:39.303047+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":77.1,"decode_tps_patched":70.4,"decode_speedup":0.9131,"decode_runs_baseline":[76.7,77.5],"decode_runs_patched":[67.8,72.9],"prefill_tps_baseline":231.8,"prefill_tps_patched":209.8,"prefill_change":-0.0949,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":16.95,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s0_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:24:25.508306+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":62.4,"decode_tps_patched":74.6,"decode_speedup":1.1955,"decode_runs_baseline":[61.6,63.2],"decode_runs_patched":[75.2,74.0],"prefill_tps_baseline":259.5,"prefill_tps_patched":288.3,"prefill_change":0.111,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s128_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:26:56.832962+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":70.0,"decode_tps_patched":77.5,"decode_speedup":1.1071,"decode_runs_baseline":[69.8,70.1],"decode_runs_patched":[76.0,78.9],"prefill_tps_baseline":291.1,"prefill_tps_patched":297.6,"prefill_change":0.0223,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_moe_mlp_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T15:16:38.019813+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":106.6,"decode_tps_patched":115.0,"decode_speedup":1.0788,"decode_runs_baseline":[106.8,106.2,106.6],"decode_runs_patched":[115.0,115.8,113.9],"prefill_tps_baseline":316.8,"prefill_tps_patched":310.9,"prefill_change":-0.0186,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
