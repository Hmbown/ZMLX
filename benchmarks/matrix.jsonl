{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_control_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:01:40.104915+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":86.6,"decode_tps_patched":92.4,"decode_speedup":1.067,"decode_runs_baseline":[86.4,86.6,86.8],"decode_runs_patched":[92.5,92.4,92.0],"prefill_tps_baseline":275.5,"prefill_tps_patched":279.4,"prefill_change":0.0142,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["glm47_rope","moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Decode-only fused RoPE+concat for glm4_moe_lite attention. capsule=benchmarks/repro_capsules/glm47_flash_rope_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:03:53.566831+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":94,"decode_tps_baseline":86.5,"decode_tps_patched":91.1,"decode_speedup":1.0532,"decode_runs_baseline":[84.9,86.8,86.5],"decode_runs_patched":[92.0,91.1,91.0],"prefill_tps_baseline":276.9,"prefill_tps_patched":280.3,"prefill_change":0.0123,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: overlap shared_experts(x) on a separate stream. capsule=benchmarks/repro_capsules/glm47_flash_shared_overlap_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"c6df299","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T01:06:18.468406+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":87.1,"decode_tps_patched":61.4,"decode_speedup":0.7049,"decode_runs_baseline":[85.1,87.1,87.1],"decode_runs_patched":[61.5,61.4,61.2],"prefill_tps_baseline":276.0,"prefill_tps_patched":243.3,"prefill_change":-0.1185,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_control_kv4_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"e1165ef","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T05:46:01.048859+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":73.9,"decode_tps_patched":80.7,"decode_speedup":1.092,"decode_runs_baseline":[73.2,74.1,73.9],"decode_runs_patched":[81.1,79.3,80.7],"prefill_tps_baseline":285.6,"prefill_tps_patched":292.2,"prefill_change":0.0231,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":17.51,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","residual_norm","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: residual_norm fusion (breaks greedy token fidelity on GLM-4.7-Flash in current testing). capsule=benchmarks/repro_capsules/glm47_flash_residual_norm_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"2f08b4e","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T05:58:35.761777+00:00","fidelity":"FAIL","fidelity_detail":"1/200 tokens identical","modules_patched":94,"decode_tps_baseline":80.7,"decode_tps_patched":87.3,"decode_speedup":1.0818,"decode_runs_baseline":[77.9,80.7,85.5],"decode_runs_patched":[87.3,86.7,88.3],"prefill_tps_baseline":273.9,"prefill_tps_patched":270.4,"prefill_change":-0.0128,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_downproj_combine_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"8c00216","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T09:14:16.824460+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":87.6,"decode_tps_patched":93.8,"decode_speedup":1.0708,"decode_runs_baseline":[86.4,87.6,87.6],"decode_runs_patched":[91.9,93.8,93.8],"prefill_tps_baseline":274.4,"prefill_tps_patched":270.0,"prefill_change":-0.016,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["swiglu_mlp","moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: fuse down-proj + combine for decode-like shapes (GLM only; token-fidelity-sensitive). capsule=benchmarks/repro_capsules/glm47_flash_downproj_combine_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"8c00216","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T09:14:16.829819+00:00","fidelity":"SKIP","fidelity_detail":"SKIPPED: unsafe variant (pass --allow-unsafe to run; may crash with Metal OOM)","modules_patched":0,"decode_tps_baseline":87.6,"decode_tps_patched":0.0,"decode_speedup":0.0,"decode_runs_baseline":[86.4,87.6,87.6],"decode_runs_patched":[],"prefill_tps_baseline":274.4,"prefill_tps_patched":0.0,"prefill_change":-1.0,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":0.0,"max_tokens":200,"gen_tokens":0,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"perf/qwen3-glm47-next baseline control","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"812f21f","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T13:12:26.917441+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":47,"decode_tps_baseline":78.18,"decode_tps_patched":79.81,"decode_speedup":1.0208,"decode_runs_baseline":[77.7,78.76,78.18],"decode_runs_patched":[74.7,79.81,81.58],"prefill_tps_baseline":260.31,"prefill_tps_patched":261.2,"prefill_change":0.0034,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"perf/qwen3-glm47-next baseline qwen3","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"812f21f","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T13:15:38.086899+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":105.61,"decode_tps_patched":112.61,"decode_speedup":1.0663,"decode_runs_baseline":[105.66,103.95,105.61],"decode_runs_patched":[112.79,112.61,112.21],"prefill_tps_baseline":314.06,"prefill_tps_patched":316.6,"prefill_change":0.0081,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_nokv_t1024_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"48c7570","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:21:39.303047+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":77.1,"decode_tps_patched":70.4,"decode_speedup":0.9131,"decode_runs_baseline":[76.7,77.5],"decode_runs_patched":[67.8,72.9],"prefill_tps_baseline":231.8,"prefill_tps_patched":209.8,"prefill_change":-0.0949,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":16.95,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s0_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:24:25.508306+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":62.4,"decode_tps_patched":74.6,"decode_speedup":1.1955,"decode_runs_baseline":[61.6,63.2],"decode_runs_patched":[75.2,74.0],"prefill_tps_baseline":259.5,"prefill_tps_patched":288.3,"prefill_change":0.111,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s128_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T14:26:56.832962+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":47,"decode_tps_baseline":70.0,"decode_tps_patched":77.5,"decode_speedup":1.1071,"decode_runs_baseline":[69.8,70.1],"decode_runs_patched":[76.0,78.9],"prefill_tps_baseline":291.1,"prefill_tps_patched":297.6,"prefill_change":0.0223,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_moe_mlp_m4max_20260205.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"d9fc18a","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T15:16:38.019813+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":106.6,"decode_tps_patched":115.0,"decode_speedup":1.0788,"decode_runs_baseline":[106.8,106.2,106.6],"decode_runs_patched":[115.0,115.8,113.9],"prefill_tps_baseline":316.8,"prefill_tps_patched":310.9,"prefill_change":-0.0186,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_shared_experts_swiglu_m4max_20260205_1d9ee0e.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1d9ee0e","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T15:55:51.617983+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":93,"decode_tps_baseline":60.8,"decode_tps_patched":66.2,"decode_speedup":1.0888,"decode_runs_baseline":[61.9,60.6,60.8],"decode_runs_patched":[64.2,66.2,69.0],"prefill_tps_baseline":212.8,"prefill_tps_patched":221.5,"prefill_change":0.0409,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"GLM-4.7-Flash: stress bench capsules added (glm_stress_m4_20260205_d17ab1b.json, glm_stress_quick_m4_20260205_d17ab1b.json). Shared-experts SwiGLU fusion enabled (swiglu_mlp matches shared_experts). Downproj+combine experiment remains off (OOM/token drift previously).","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"07bdf22","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T17:28:49.810596+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":93,"decode_tps_baseline":86.49,"decode_tps_patched":91.73,"decode_speedup":1.0606,"decode_runs_baseline":[86.0,86.49,86.83],"decode_runs_patched":[92.44,91.73,89.92],"prefill_tps_baseline":265.69,"prefill_tps_patched":261.68,"prefill_change":-0.0151,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_moe_mlp_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T19:54:48.714409+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":115.3,"decode_tps_patched":117.0,"decode_speedup":1.0147,"decode_runs_baseline":[116.8,115.3,114.6],"decode_runs_patched":[114.1,121.2,117.0],"prefill_tps_baseline":304.6,"prefill_tps_patched":328.1,"prefill_change":0.0772,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_control_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:00:19.575473+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":93,"decode_tps_baseline":79.5,"decode_tps_patched":71.6,"decode_speedup":0.9006,"decode_runs_baseline":[82.2,79.5,78.6],"decode_runs_patched":[71.6,72.4,71.4],"prefill_tps_baseline":265.5,"prefill_tps_patched":237.9,"prefill_change":-0.104,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["glm47_rope","moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Decode-only fused RoPE+concat for glm4_moe_lite attention. capsule=benchmarks/repro_capsules/glm47_flash_rope_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:01:57.165259+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":140,"decode_tps_baseline":71.7,"decode_tps_patched":72.6,"decode_speedup":1.0126,"decode_runs_baseline":[70.3,71.7,71.9],"decode_runs_patched":[71.6,72.6,73.6],"prefill_tps_baseline":245.7,"prefill_tps_patched":248.3,"prefill_change":0.0106,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: overlap shared_experts(x) on a separate stream. capsule=benchmarks/repro_capsules/glm47_flash_shared_overlap_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:03:39.052480+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":93,"decode_tps_baseline":70.7,"decode_tps_patched":51.9,"decode_speedup":0.7341,"decode_runs_baseline":[70.9,70.4,70.7],"decode_runs_patched":[51.9,52.0,51.6],"prefill_tps_baseline":246.2,"prefill_tps_patched":208.2,"prefill_change":-0.1543,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","residual_norm","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Experimental: residual_norm fusion (breaks greedy token fidelity on GLM-4.7-Flash in current testing). capsule=benchmarks/repro_capsules/glm47_flash_residual_norm_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:05:22.535891+00:00","fidelity":"FAIL","fidelity_detail":"1/200 tokens identical","modules_patched":140,"decode_tps_baseline":69.7,"decode_tps_patched":69.0,"decode_speedup":0.99,"decode_runs_baseline":[68.8,69.7,69.8],"decode_runs_patched":[67.6,69.0,69.3],"prefill_tps_baseline":240.4,"prefill_tps_patched":239.2,"prefill_change":-0.005,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, profile='qwen3') capsule=benchmarks/repro_capsules/qwen3_a3b_profile_qwen3_m4max_20260205_rerun2_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:56:06.833059+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":96.5,"decode_tps_patched":104.3,"decode_speedup":1.0808,"decode_runs_baseline":[97.6,96.5,96.2],"decode_runs_patched":[104.3,103.2,104.6],"prefill_tps_baseline":296.7,"prefill_tps_patched":300.0,"prefill_change":0.0111,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_moe_mlp_m4max_20260205_rerun3_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T20:58:09.984951+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":97.5,"decode_tps_patched":104.0,"decode_speedup":1.0667,"decode_runs_baseline":[97.5,98.1,97.4],"decode_runs_patched":[103.7,104.5,104.0],"prefill_tps_baseline":294.0,"prefill_tps_patched":296.1,"prefill_change":0.0071,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_nokv_t1024_m4max_20260205_rerun_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:02:35.797815+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":93,"decode_tps_baseline":67.1,"decode_tps_patched":70.2,"decode_speedup":1.0462,"decode_runs_baseline":[66.9,67.3],"decode_runs_patched":[70.3,70.1],"prefill_tps_baseline":206.3,"prefill_tps_patched":211.5,"prefill_change":0.0252,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":16.95,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s0_m4max_20260205_rerun_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:05:11.384177+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":93,"decode_tps_baseline":61.6,"decode_tps_patched":65.8,"decode_speedup":1.0682,"decode_runs_baseline":[61.5,61.7],"decode_runs_patched":[65.8,65.8],"prefill_tps_baseline":247.5,"prefill_tps_patched":252.3,"prefill_change":0.0194,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/glm47_flash_kv4_t1024_s128_m4max_20260205_rerun_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:07:38.917947+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":93,"decode_tps_baseline":72.9,"decode_tps_patched":78.9,"decode_speedup":1.0823,"decode_runs_baseline":[73.9,71.9],"decode_runs_patched":[78.8,79.0],"prefill_tps_baseline":276.3,"prefill_tps_patched":284.0,"prefill_change":0.0279,"peak_mem_baseline_gb":16.93,"peak_mem_patched_gb":17.51,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_nokv_t1024_m4max_20260205_rerun_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:09:57.452038+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":48,"decode_tps_baseline":114.9,"decode_tps_patched":120.9,"decode_speedup":1.0522,"decode_runs_baseline":[114.9,115.0],"decode_runs_patched":[121.0,120.9],"prefill_tps_baseline":323.7,"prefill_tps_patched":331.8,"prefill_change":0.025,"peak_mem_baseline_gb":17.33,"peak_mem_patched_gb":17.34,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_kv4_t1024_s128_m4max_20260205_rerun_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:12:10.227870+00:00","fidelity":"PASS","fidelity_detail":"1024/1024 tokens identical","modules_patched":48,"decode_tps_baseline":88.3,"decode_tps_patched":93.8,"decode_speedup":1.0623,"decode_runs_baseline":[94.8,81.9],"decode_runs_patched":[91.5,96.1],"prefill_tps_baseline":306.4,"prefill_tps_patched":321.1,"prefill_change":0.048,"peak_mem_baseline_gb":17.27,"peak_mem_patched_gb":17.27,"max_tokens":1024,"gen_tokens":1024,"runs":2}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, patterns=['moe_mlp']) capsule=benchmarks/repro_capsules/qwen3_a3b_moe_mlp_m4max_20260205_posthotpath_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:18:11.361954+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":97.0,"decode_tps_patched":103.2,"decode_speedup":1.0639,"decode_runs_baseline":[97.2,97.0,91.8],"decode_runs_patched":[103.0,103.2,103.4],"prefill_tps_baseline":290.2,"prefill_tps_patched":295.9,"prefill_change":0.0196,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: patch(model, profile='qwen3') capsule=benchmarks/repro_capsules/qwen3_a3b_profile_qwen3_m4max_20260205_posthotpath_r5_mlx0304dev2f324cc.json","macos_version":"26.1","mlx_version":"0.30.4.dev20260204+2f324cc","zmlx_version":"0.8.0","zmlx_commit":"1ddbb84","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-05T21:24:48.541939+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":48,"decode_tps_baseline":84.5,"decode_tps_patched":98.4,"decode_speedup":1.1645,"decode_runs_baseline":[100.9,84.5,81.0,89.2,74.7],"decode_runs_patched":[98.7,98.7,98.4,85.0,77.5],"prefill_tps_baseline":287.5,"prefill_tps_patched":291.3,"prefill_change":0.0132,"peak_mem_baseline_gb":17.24,"peak_mem_patched_gb":17.24,"max_tokens":200,"gen_tokens":200,"runs":5}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 default patch revalidation: fidelity pass, gather_qmm_swiglu path","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:16:36.620372+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":46,"decode_tps_baseline":82.23,"decode_tps_patched":89.63,"decode_speedup":1.09,"decode_runs_baseline":[82.23,82.74,80.73],"decode_runs_patched":[89.63,90.18,89.19],"prefill_tps_baseline":262.45,"prefill_tps_patched":279.65,"prefill_change":0.0655,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["rmsnorm"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 explicit rmsnorm check: fidelity fail + decode regression","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:17:37.364555+00:00","fidelity":"FAIL","fidelity_detail":"160/200 tokens identical","modules_patched":189,"decode_tps_baseline":84.61,"decode_tps_patched":70.75,"decode_speedup":0.8362,"decode_runs_baseline":[84.61],"decode_runs_patched":[70.75],"prefill_tps_baseline":291.71,"prefill_tps_patched":283.28,"prefill_change":-0.0289,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":1}
{"model_id":"mlx-community/LFM2-8B-A1B-4bit","model_family":"lfm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:19:37.580075+00:00","fidelity":"PASS","fidelity_detail":"430/430 tokens identical","modules_patched":24,"decode_tps_baseline":220.97,"decode_tps_patched":251.7,"decode_speedup":1.139,"decode_runs_baseline":[220.97],"decode_runs_patched":[251.7],"prefill_tps_baseline":721.28,"prefill_tps_patched":750.22,"prefill_change":0.0401,"peak_mem_baseline_gb":5.3,"peak_mem_patched_gb":5.3,"max_tokens":1000,"gen_tokens":430,"runs":1}
{"model_id":"mlx-community/LFM2-8B-A1B-8bit","model_family":"lfm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:20:05.754654+00:00","fidelity":"PASS","fidelity_detail":"1000/1000 tokens identical","modules_patched":24,"decode_tps_baseline":149.55,"decode_tps_patched":168.79,"decode_speedup":1.1287,"decode_runs_baseline":[149.55],"decode_runs_patched":[168.79],"prefill_tps_baseline":543.54,"prefill_tps_patched":569.57,"prefill_change":0.0479,"peak_mem_baseline_gb":9.45,"peak_mem_patched_gb":9.45,"max_tokens":1000,"gen_tokens":1000,"runs":1}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:21:18.876943+00:00","fidelity":"PASS","fidelity_detail":"1000/1000 tokens identical","modules_patched":46,"decode_tps_baseline":80.0,"decode_tps_patched":72.59,"decode_speedup":0.9074,"decode_runs_baseline":[80.0],"decode_runs_patched":[72.59],"prefill_tps_baseline":284.59,"prefill_tps_patched":302.74,"prefill_change":0.0638,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":16.95,"max_tokens":1000,"gen_tokens":1000,"runs":1}
{"model_id":"mlx-community/LFM2-8B-A1B-4bit","model_family":"lfm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe 4bit-only sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:22:53.950204+00:00","fidelity":"PASS","fidelity_detail":"430/430 tokens identical","modules_patched":24,"decode_tps_baseline":209.79,"decode_tps_patched":235.68,"decode_speedup":1.1234,"decode_runs_baseline":[209.79],"decode_runs_patched":[235.68],"prefill_tps_baseline":658.05,"prefill_tps_patched":704.18,"prefill_change":0.0701,"peak_mem_baseline_gb":5.3,"peak_mem_patched_gb":5.3,"max_tokens":1000,"gen_tokens":430,"runs":1}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe 4bit-only sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:24:10.437695+00:00","fidelity":"PASS","fidelity_detail":"1000/1000 tokens identical","modules_patched":46,"decode_tps_baseline":74.54,"decode_tps_patched":78.57,"decode_speedup":1.0541,"decode_runs_baseline":[74.54],"decode_runs_patched":[78.57],"prefill_tps_baseline":280.6,"prefill_tps_patched":294.31,"prefill_change":0.0489,"peak_mem_baseline_gb":16.94,"peak_mem_patched_gb":16.95,"max_tokens":1000,"gen_tokens":1000,"runs":1}
{"model_id":"mlx-community/Qwen3-30B-A3B-4bit","model_family":"qwen","architecture":"moe","patterns_applied":["moe_mlp"],"hardware":"Apple M4 Max 36GB","notes":"2026-02-08 moe 4bit-only sweep 1000t runs=1 default patch","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.2","zmlx_commit":"c1649bc","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-08T22:25:19.601544+00:00","fidelity":"PASS","fidelity_detail":"1000/1000 tokens identical","modules_patched":48,"decode_tps_baseline":103.27,"decode_tps_patched":106.26,"decode_speedup":1.029,"decode_runs_baseline":[103.27],"decode_runs_patched":[106.26],"prefill_tps_baseline":308.01,"prefill_tps_patched":320.1,"prefill_change":0.0393,"peak_mem_baseline_gb":17.33,"peak_mem_patched_gb":17.34,"max_tokens":1000,"gen_tokens":1000,"runs":1}
{"model_id":"mlx-community/GLM-4.7-Flash-4bit","model_family":"glm","architecture":"moe","patterns_applied":["moe_mlp","swiglu_mlp"],"hardware":"Apple M4 Max 36GB","notes":"Control: current best patch set (no RoPE fusion). capsule=benchmarks/repro_capsules/baseline.json","macos_version":"26.1","mlx_version":"0.30.7.dev20260207+8fe1d092","zmlx_version":"0.8.3","zmlx_commit":"348fe04","python_version":"3.14.2","custom_mlx":true,"timestamp":"2026-02-10T02:30:36.964476+00:00","fidelity":"PASS","fidelity_detail":"200/200 tokens identical","modules_patched":93,"decode_tps_baseline":76.3,"decode_tps_patched":78.0,"decode_speedup":1.0223,"decode_runs_baseline":[75.0,76.6,76.3],"decode_runs_patched":[77.7,78.0,78.4],"prefill_tps_baseline":259.1,"prefill_tps_patched":263.4,"prefill_change":0.0166,"peak_mem_baseline_gb":16.91,"peak_mem_patched_gb":16.91,"max_tokens":200,"gen_tokens":200,"runs":3}
